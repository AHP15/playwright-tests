# Test info

- Name: Should fail
- Location: /home/runner/work/playwright-tests/playwright-tests/tests/example.spec.ts:20:1

# Error details

```
Error: expect(received).toBe(expected) // Object.is equality

Expected: false
Received: true
    at /home/runner/work/playwright-tests/playwright-tests/tests/example.spec.ts:21:16
```

# Test source

```ts
   1 | import { test, expect } from '@playwright/test';
   2 |
   3 | test('has title', async ({ page }) => {
   4 |   await page.goto('https://playwright.dev/');
   5 |
   6 |   // Expect a title "to contain" a substring.
   7 |   await expect(page).toHaveTitle(/Playwright/);
   8 | });
   9 |
  10 | test('get started link', async ({ page }) => {
  11 |   await page.goto('https://playwright.dev/');
  12 |
  13 |   // Click the get started link.
  14 |   await page.getByRole('link', { name: 'Get started' }).click();
  15 |
  16 |   // Expects page to have a heading with the name of Installation.
  17 |   await expect(page.getByRole('heading', { name: 'Installation' })).toBeVisible();
  18 | });
  19 |
  20 | test('Should fail', async ({}) => {
> 21 |   expect(true).toBe(false);
     |                ^ Error: expect(received).toBe(expected) // Object.is equality
  22 | })
  23 |
```

# Local changes

```diff
diff --git a/.github/scripts/parse-test-results.mjs b/.github/scripts/parse-test-results.mjs
index f5b77d3..6d1bec3 100644
--- a/.github/scripts/parse-test-results.mjs
+++ b/.github/scripts/parse-test-results.mjs
@@ -7,6 +7,7 @@ const workspaceDir = process.env.GITHUB_WORKSPACE || '.';
 // The path to the Playwright test results file is configured in the Playwright config file.
 const reportFilePath = join(workspaceDir, 'playwright-report', 'results.json');
 
+let total = 0;
 let passed = 0;
 let failed = 0;
 let flaky = 0;
@@ -22,10 +23,11 @@ try {
   const { stats } = report;
   if (!stats) throw new Error('No suites found in test results');
 
-  passed = stats.expected ?? 0;
+  total = stats.expected ?? 0;
   failed = stats.unexpected ?? 0;
   flaky = stats.flaky ?? 0;
   skipped = stats.skipped ?? 0;
+  passed = total - failed - flaky;
 
   info(`Parsing successful: Passed=${passed}, Failed=${failed}, Flaky=${flaky}, Skipped=${skipped}`);
 
@@ -34,6 +36,7 @@ try {
   setFailed(`Script failed: ${err.message}`);
 }
 
+setOutput('total', total);
 setOutput('passed', passed);
 setOutput('failed', failed);
 setOutput('flaky', flaky);
diff --git a/.github/scripts/pr-comment.mjs b/.github/scripts/pr-comment.mjs
index c9a4b9f..e2fe3e5 100644
--- a/.github/scripts/pr-comment.mjs
+++ b/.github/scripts/pr-comment.mjs
@@ -13,18 +13,56 @@ try {
   const octokit = getOctokit(token);
   const { owner, repo, number } = context.issue
 
-  const commentBody = `Hey`;
+  const { TOTAL, PASSED, FAILED, FLAKY, SKIPPED, REPORT_FOLDER } = process.env;
 
-  await octokit.rest.issues.createComment({
+  const commentTitle = `# Playwright Test Results ${FAILED > 0 ? '❌' : '✅'}`;
+  const commentBody = `
+  ${commentTitle}
+  ## Summary
+  - **Total**: ${TOTAL}
+  - **Passed**: ${PASSED}
+  - **Failed**: ${FAILED}
+  - **Flaky**: ${FLAKY}
+  - **Skipped**: ${SKIPPED}
+  ## Details
+  [Report Link](${`https://${owner}.github.io/${repo}/${REPORT_FOLDER}`})
+  [ALL tests Link](${`https://${owner}.github.io/${repo}}/`})
+  ## Additional Information
+  Last updated: ${new Date().toUTCString()}
+  `;
+
+   // Get all comments for this PR/issue
+   const { data: comments } = await octokit.rest.issues.listComments({
     owner,
     repo,
     issue_number: number,
-    body: commentBody,
-    headers: {
-      authorization: `token ${token}`,
-    },
   });
-  console.log('Comment created successfully');
+
+  // Look for an existing comment that starts with the same title
+  const existingComment = comments.find(comment => 
+    comment.body.trim().startsWith(commentTitle.trim())
+  )
+
+  if(existingComment) {
+    await octokit.rest.issues.updateComment({
+      owner,
+      repo,
+      comment_id: existingComment.id,
+      body: commentBody,
+    });
+    console.log('Comment updated successfully');
+  } else {
+    await octokit.rest.issues.createComment({
+      owner,
+      repo,
+      issue_number: number,
+      body: commentBody,
+      headers: {
+        authorization: `token ${token}`,
+      },
+    });
+    console.log('Comment created successfully');
+  }
 } catch (error) {
   console.error('Error creating comment:', error);
 }
diff --git a/.github/workflows/playwright.yml b/.github/workflows/playwright.yml
index fcb16a5..3b4636f 100644
--- a/.github/workflows/playwright.yml
+++ b/.github/workflows/playwright.yml
@@ -31,11 +31,11 @@ jobs:
     name: Run Tests
     needs: wait-for-deployment-url
     runs-on: ubuntu-latest
-    outputs:
-      passed: ${{ steps.extract-test-results.outputs.passed }}
-      failed: ${{ steps.extract-test-results.outputs.failed }}
-      flaky: ${{ steps.extract-test-results.outputs.flaky }}
-      skipped: ${{ steps.extract-test-results.outputs.skipped }}
+    # outputs:
+    #   passed: ${{ steps.extract-test-results.outputs.passed }}
+    #   failed: ${{ steps.extract-test-results.outputs.failed }}
+    #   flaky: ${{ steps.extract-test-results.outputs.flaky }}
+    #   skipped: ${{ steps.extract-test-results.outputs.skipped }}
     env:
       BASE_URL: ${{ needs.wait-for-deployment-url.outputs.deployment_url }}
       GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
@@ -86,4 +86,11 @@ jobs:
           commit_message: "Deploy Playwright test report"
       - name: Comment on PR
         if: ${{ github.event_name == 'pull_request' }}
+        env:
+          REPORT_FOLDER: ${{ steps.generate-folder-name.outputs.folder_name }}
+          TOTAL: ${{ steps.extract-test-results.outputs.total }}
+          PASSED: ${{ steps.extract-test-results.outputs.passed }}
+          FAILED: ${{ steps.extract-test-results.outputs.failed }}
+          FLAKY: ${{ steps.extract-test-results.outputs.flaky }}
+          SKIPPED: ${{ steps.extract-test-results.outputs.skipped }}
         run: node .github/scripts/pr-comment.mjs
diff --git a/tests/example.spec.ts b/tests/example.spec.ts
index 54a906a..f83842f 100644
--- a/tests/example.spec.ts
+++ b/tests/example.spec.ts
@@ -16,3 +16,7 @@ test('get started link', async ({ page }) => {
   // Expects page to have a heading with the name of Installation.
   await expect(page.getByRole('heading', { name: 'Installation' })).toBeVisible();
 });
+
+test('Should fail', async ({}) => {
+  expect(true).toBe(false);
+})
```