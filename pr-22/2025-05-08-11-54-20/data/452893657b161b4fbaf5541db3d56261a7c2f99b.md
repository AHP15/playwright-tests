# Test info

- Name: has title
- Location: /home/runner/work/playwright-tests/playwright-tests/tests/app.spec.ts:3:1

# Error details

```
Error: Timed out 5000ms waiting for expect(locator).toHaveTitle(expected)

Locator: locator(':root')
Expected pattern: /Vite + React Hello/
Received string:  "Vite + React + TS"
Call log:
  - expect.toHaveTitle with timeout 5000ms
  - waiting for locator(':root')
    9 × locator resolved to <html lang="en">…</html>
      - unexpected value "Vite + React + TS"

    at /home/runner/work/playwright-tests/playwright-tests/tests/app.spec.ts:7:22
```

# Page snapshot

```yaml
- link "Vite logo":
  - /url: https://vite.dev
  - img "Vite logo"
- link "React logo":
  - /url: https://react.dev
  - img "React logo"
- heading "Vite + React Hello" [level=1]
- button "count is 0"
- paragraph:
  - text: Edit
  - code: src/App.tsx
  - text: and save to test HMR
- paragraph: Click on the Vite and React logos to learn more
```

# Test source

```ts
   1 | import { test, expect } from '@playwright/test';
   2 |
   3 | test('has title', async ({ page }) => {
   4 |   await page.goto('/');
   5 |
   6 |   // Expect a title "to contain" a substring.
>  7 |   await expect(page).toHaveTitle(/Vite + React Hello/);
     |                      ^ Error: Timed out 5000ms waiting for expect(locator).toHaveTitle(expected)
   8 | });
   9 |
  10 | test('should fails', async ({ page }) => {
  11 |   await page.goto('/');
  12 |
  13 |   // Expect a title "to contain" a substring.
  14 |   await expect(page).toHaveTitle(/ok/);
  15 | });
  16 |
```

# Local changes

```diff
diff --git a/.github/scripts/cleanup.mjs b/.github/scripts/cleanup.mjs
index f8e117b..10fc727 100644
--- a/.github/scripts/cleanup.mjs
+++ b/.github/scripts/cleanup.mjs
@@ -71,7 +71,7 @@ try {
 
   console.log("Updating comments in open PRs/issues...");
 
-  // Get only OPEN issues and PRs in the repository
+  // Get issues and PRs separately to ensure we process both
   const allOpenIssues = await octokit.paginate(
     octokit.rest.issues.listForRepo,
     {
@@ -79,6 +79,7 @@ try {
       repo,
       state: "open",
       per_page: 100,
+      filter: "all"  // Explicitly request all issues
     }
   );
 
@@ -90,6 +91,9 @@ try {
   let updatedCommentCount = 0;
 
   for (const issue of allOpenIssues) {
+    console.log(`Processing ${issue.pull_request ? "PR" : "Issue"} #${issue.number}`);
+
+    // Get all comments for the issue/PR
     const { data: comments } = await octokit.rest.issues.listComments({
       owner,
       repo,
@@ -97,37 +101,54 @@ try {
       per_page: 100,
     });
 
-    const matchingComments = comments.filter((comment) =>
-      comment.body.trim().startsWith(commentTitle.trim())
+    // More flexible matching to catch variations in comment formatting
+    const matchingComments = comments.filter((comment) => 
+      comment.body && (
+        comment.body.trim().startsWith(commentTitle.trim()) || 
+        comment.body.includes(commentTitle.trim())
+      )
     );
 
     if (matchingComments.length > 0) {
       console.log(
-        `Found ${matchingComments.length} Playwright test comments in open issue/PR #${issue.number}`
+        `Found ${matchingComments.length} Playwright test comments in ${issue.pull_request ? "PR" : "Issue"} #${issue.number}`
       );
     }
 
     for (const comment of matchingComments) {
-      const newBody = comment.body.replace(
-        commentTitle,
-        `# Playwright Test Results [DELETED]`
-      );
+      // Update the comment title
+      let newBody = comment.body;
+      if (newBody.includes(commentTitle)) {
+        newBody = newBody.replace(
+          commentTitle,
+          `# Playwright Test Results [DELETED]`
+        );
+      }
 
       // Add a notice about reports being deleted
       const deletedNotice = `\n\n**NOTICE: All reports have been deleted from the gh-pages branch.**\nDeleted on: ${new Date().toUTCString()}, to see the reports please re-run the test action.`;
 
+      // Make sure we don't duplicate the notice if updating multiple times
+      if (!newBody.includes("**NOTICE: All reports have been deleted")) {
+        newBody += deletedNotice;
+      }
+
       // Update the comment
-      await octokit.rest.issues.updateComment({
-        owner,
-        repo,
-        comment_id: comment.id,
-        body: newBody + deletedNotice,
-      });
-
-      updatedCommentCount++;
-      console.log(
-        `Updated comment ${comment.id} in open issue/PR #${issue.number} to indicate deletion`
-      );
+      try {
+        await octokit.rest.issues.updateComment({
+          owner,
+          repo,
+          comment_id: comment.id,
+          body: newBody,
+        });
+
+        updatedCommentCount++;
+        console.log(
+          `Updated comment ${comment.id} in ${issue.pull_request ? "PR" : "Issue"} #${issue.number} to indicate deletion`
+        );
+      } catch (error) {
+        console.error(`Failed to update comment ${comment.id}: ${error.message}`);
+      }
     }
   }
 
diff --git a/.github/workflows/playwright.yml b/.github/workflows/playwright.yml
index 776925b..82a5ee2 100644
--- a/.github/workflows/playwright.yml
+++ b/.github/workflows/playwright.yml
@@ -50,7 +50,7 @@ jobs:
       - name: Run Playwright tests
         continue-on-error: true
         env:
-          BASE_URL: "https://ff-customer-portal-git-${{ env.GITHUB_REF_NAME }}-egaliti.vercel.app"
+          BASE_URL: "https://playwright-tests-git-${{ env.GITHUB_REF_NAME }}-abdessittir-harkatis-projects.vercel.app"
         run: npx playwright test
 
       - name: extract test results
```