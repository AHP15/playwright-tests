# Test info

- Name: should fails
- Location: /home/runner/work/playwright-tests/playwright-tests/tests/app.spec.ts:10:1

# Error details

```
Error: Timed out 5000ms waiting for expect(locator).toHaveTitle(expected)

Locator: locator(':root')
Expected pattern: /ok/
Received string:  "404: NOT_FOUND"
Call log:
  - expect.toHaveTitle with timeout 5000ms
  - waiting for locator(':root')
    9 × locator resolved to <html lang="en">…</html>
      - unexpected value "404: NOT_FOUND"

    at /home/runner/work/playwright-tests/playwright-tests/tests/app.spec.ts:14:22
```

# Page snapshot

```yaml
- main:
  - paragraph:
    - strong: "404"
    - text: ": NOT_FOUND Code:"
    - code: "`DEPLOYMENT_NOT_FOUND`"
    - text: "ID:"
    - code: "`cle1::xf7gb-1746696103560-744c95808d86`"
  - link "This deployment cannot be found. For more information and troubleshooting, see our documentation.":
    - /url: https://vercel.com/docs/errors/platform-error-codes#deployment_not_found
```

# Test source

```ts
   1 | import { test, expect } from '@playwright/test';
   2 |
   3 | test('has title', async ({ page }) => {
   4 |   await page.goto('/');
   5 |
   6 |   // Expect a title "to contain" a substring.
   7 |   await expect(page).toHaveTitle(/Vite + React Hello/);
   8 | });
   9 |
  10 | test('should fails', async ({ page }) => {
  11 |   await page.goto('/');
  12 |
  13 |   // Expect a title "to contain" a substring.
> 14 |   await expect(page).toHaveTitle(/ok/);
     |                      ^ Error: Timed out 5000ms waiting for expect(locator).toHaveTitle(expected)
  15 | });
  16 |
```

# Local changes

```diff
diff --git a/.github/scripts/cleanup.mjs b/.github/scripts/cleanup.mjs
new file mode 100644
index 0000000..ee2c0a1
--- /dev/null
+++ b/.github/scripts/cleanup.mjs
@@ -0,0 +1,105 @@
+import { getOctokit, context } from '@actions/github';
+import * as core from '@actions/core';
+import process from 'process';
+import { exec } from '@actions/exec';
+import * as fs from 'fs';
+import * as path from 'path';
+import process from 'process';
+
+try {
+  const token = process.env.GITHUB_TOKEN || core.getInput('github-token');
+    if (!token) {
+      throw new Error('No GitHub token provided.');
+    }
+
+    const octokit = getOctokit(token);
+    const { owner, repo } = context.repo;
+
+    await exec('git', ['config', '--global', 'user.name', 'github-actions']);
+    await exec('git', ['config', '--global', 'user.email', 'github-actions@github.com']);
+
+    const tempDir = path.join(process.cwd(), 'gh-pages-temp');
+    if (fs.existsSync(tempDir)) {
+      fs.rmSync(tempDir, { recursive: true, force: true });
+    }
+    fs.mkdirSync(tempDir);
+
+    const repoURL = `https://x-access-token:${token}@github.com/${owner}/${repo}.git`;
+    console.log('Checking out gh-pages branch...');
+    await exec(
+      'git',
+      ['clone', repoURL, tempDir, '--branch', 'gh-pages']
+    ).catch(async (error) => {
+      console.log('gh-pages branch does not exist yet, creating it...');
+      await exec.exec('git', ['init', tempDir]);
+      process.chdir(tempDir);
+      await exec.exec('git', ['checkout', '--orphan', 'gh-pages']);
+      await exec.exec('git', ['remote', 'add', 'origin', repoURL]);
+      process.chdir('..');
+    });
+
+    process.chdir(tempDir);
+
+    // If the branch exists and has files, remove all files except .git
+    const files = fs.readdirSync('.');
+    for (const file of files) {
+      if (file !== '.git') {
+        const filePath = path.join('.', file);
+        if (fs.lstatSync(filePath).isDirectory()) {
+          fs.rmSync(filePath, { recursive: true, force: true });
+        } else {
+          fs.unlinkSync(filePath);
+        }
+      }
+    }
+    
+    // Add a .nojekyll file to bypass Jekyll processing
+    fs.writeFileSync('.nojekyll', '');
+
+    // Add, commit, and push changes
+    console.log('Committing empty gh-pages branch...');
+    await exec.exec('git', ['add', '-A']);
+    await exec.exec('git', ['commit', '-m', 'Clear gh-pages branch', '--allow-empty']);
+    
+    console.log('Pushing changes...');
+    await exec.exec('git', ['push', '-f', 'origin', 'gh-pages']);
+    
+    console.log('Successfully cleared gh-pages branch');
+
+    // update PR comments to indacate that the gh-pages branch has been cleared
+    const { data: comments } = await octokit.rest.issues.listComments({
+      owner,
+      repo,
+      issue_number: number,
+    });
+
+    const commentTitle = '# Playwright Test Results'
+    const existingComments = comments.filter(comment => 
+      comment.body.trim().startsWith(commentTitle.trim())
+    );
+
+    // Update each existing comment to include 'DELETED'
+    for (const comment of existingComments) {
+      // Create the new comment body with DELETED marker
+      const newBody = comment.body.replace(
+        commentTitle,
+        `# Playwright Test Results [DELETED]`
+      );
+    
+      // Add a notice about reports being deleted
+      const deletedNotice = `\n\n**NOTICE: All reports have been deleted from the gh-pages branch.**\nDeleted on: ${new Date().toUTCString()}, to see the reports please re-run the test action.`;
+    
+      // Update the comment
+      await octokit.rest.issues.updateComment({
+        owner,
+        repo,
+        comment_id: comment.id,
+        body: newBody + deletedNotice,
+      });
+    
+      console.log(`Updated comment ${comment.id} to indicate deletion`);
+    }
+
+} catch (error) {
+  core.setFailed(`Action failed with error ${error}`);
+}
\ No newline at end of file
diff --git a/.github/workflows/cleanup.yml b/.github/workflows/cleanup.yml
new file mode 100644
index 0000000..938395f
--- /dev/null
+++ b/.github/workflows/cleanup.yml
@@ -0,0 +1,24 @@
+name: Cleanup Tests Reports
+
+on:
+  schedule:
+    - cron: "*/5 * * * *" # Run every 5 minutes
+
+jobs:
+  cleanup:
+    runs-on: ubuntu-latest
+    steps:
+      - name: Checkout repository
+        uses: actions/checkout@v2
+
+      - name: Set up Node.js
+        uses: actions/setup-node@v4
+        with:
+          node-version: "lts/*"
+          cache: "npm"
+
+      - name: Install dependencies
+        run: npm ci
+
+      - name: Remove test reports
+        run: node .github/workflows/cleanup.mjs
diff --git a/.github/workflows/playwright.yml b/.github/workflows/playwright.yml
index 63cc1ec..776925b 100644
--- a/.github/workflows/playwright.yml
+++ b/.github/workflows/playwright.yml
@@ -19,7 +19,6 @@ jobs:
     name: Run Tests
     runs-on: ubuntu-latest
     env:
-      BASE_URL: https://ff-customer-portal-git-${{github.ref_name}}-egaliti.vercel.app
       GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
     steps:
       - name: wait for deployment to finish
diff --git a/package-lock.json b/package-lock.json
index 2cfa604..cb9a12d 100644
--- a/package-lock.json
+++ b/package-lock.json
@@ -9,6 +9,7 @@
       "version": "0.0.0",
       "dependencies": {
         "@actions/core": "^1.11.1",
+        "@actions/exec": "^1.1.1",
         "@actions/github": "^6.0.0",
         "react": "^19.1.0",
         "react-dom": "^19.1.0"
diff --git a/package.json b/package.json
index a5fc5b4..a483b1d 100644
--- a/package.json
+++ b/package.json
@@ -11,6 +11,7 @@
   },
   "dependencies": {
     "@actions/core": "^1.11.1",
+    "@actions/exec": "^1.1.1",
     "@actions/github": "^6.0.0",
     "react": "^19.1.0",
     "react-dom": "^19.1.0"
diff --git a/playwright.config.ts b/playwright.config.ts
index bb04b99..4de6b09 100644
--- a/playwright.config.ts
+++ b/playwright.config.ts
@@ -30,7 +30,7 @@ export default defineConfig({
     screenshot: 'only-on-failure',
 
     /* Collect trace when retrying the failed test. See https://playwright.dev/docs/trace-viewer */
-    trace: 'on-first-retry',
+    trace: process.env.CI ? 'on' : 'on-first-retry',
   },
 
   /* Configure projects for major browsers */
```